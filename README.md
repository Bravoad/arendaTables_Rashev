# API-сервис бронирования столиков ресторана

Это REST API-сервис для бронирования столиков в ресторане. Сервис позволяет:
- Создавать, просматривать и удалять столики
- Создавать, просматривать и удалять бронирования
- Проверять, свободен ли столик в указанное время, что предотвращает конфликты бронирования

Проект реализован с помощью:
- **FastAPI** – фреймворка для создания высокопроизводительных API
- **SQLAlchemy**/SQLModel – для работы с базой данных (PostgreSQL)
- **Alembic** – для управления миграциями базы данных
- **Docker** и **docker-compose** – для контейнеризации приложения и БД
- **PgAdmin** – для удобного управления и администрирования базы данных

## Структура проекта

```
project/
├── app/
│   ├── main.py              # Точка входа FastAPI приложения
│   ├── config.py            # Конфигурация приложения (настройки, подключение к БД)
│   ├── models/              # Модели БД (Table, Reservation)
│   ├── schemas/             # Схемы Pydantic для валидации данных
│   ├── routers/             # API-роутеры для столиков и бронирований
│   ├── services/            # Бизнес-логика (сервисы по работе с БД)
│   └── db/
│       └── session.py       # Инициализация подключения к базе данных
├── alembic/
│   ├── env.py               # Конфигурация миграций Alembic
│   ├── script.py.mako       # Шаблон для миграционных скриптов
│   └── versions/            # Каталог для миграционных версий
├── tests/                   # Тесты с использованием pytest
├── Dockerfile               # Докерфайл для сборки приложения
├── docker-compose.yml       # Основной docker-compose файл (включает сервисы web и db)
├── docker-compose.override.yml  # Дополнительная конфигурация (например, добавление pgAdmin)
├── .env                   # Файл с переменными окружения
└── README.md                # Инструкция по запуску проекта
```

## Как запустить проект

### Предварительные требования

Установите на вашей машине:
- [Docker](https://docs.docker.com/get-docker/)
- [Docker Compose](https://docs.docker.com/compose/install/)

### 1. Клонирование репозитория

```bash
git clone <URL вашего репозитория>
cd project
```

### 2. Настройка переменных окружения

В корневой директории создайте файл **.env** (если он ещё не существует) и добавьте в него следующие значения:

```dotenv
POSTGRES_USER=user
POSTGRES_PASSWORD=password
POSTGRES_DB=restaurant_db
POSTGRES_HOST=db
POSTGRES_PORT=5432
APP_HOST=0.0.0.0
APP_PORT=8000
DEBUG=True
ALEMBIC_CONFIG=../alembic.ini
```

> **Совет:** Убедитесь, что в файле нет лишних пробелов или пустых строк.

### 3. Запуск сервисов

Используя Docker Compose, соберите и запустите контейнеры:

```bash
docker-compose up --build
```

Это поднимет:
- **db** – PostgreSQL
- **web** – FastAPI приложение

Если используется **docker-compose.override.yml**, будет также запущен сервис **pgAdmin** для управления базой данных.

### 4. Применение миграций Alembic

После запуска контейнеров в терминале выполните:

```bash
docker-compose exec web alembic upgrade head
```

Эта команда применит все миграции к вашей базе данных, создав необходимые таблицы.

### 5. Доступ к API

После запуска проект будет доступен по адресу:

```
http://localhost:8000
```

Документация Swagger (интерактивный интерфейс API) находится по адресу:

```
http://localhost:8000/docs
```

### 6. Управление базой данных через pgAdmin (опционально)

Если вы используете pgAdmin (запускается через **docker-compose.override.yml**), откройте браузер и перейдите по адресу:

```
http://localhost:5050
```

Войдите, используя:
- **Email:** admin@admin.com
- **Пароль:** admin

Создайте сервер со следующими параметрами:
- **Host name/address:** db
- **Port:** 5432
- **Username:** user
- **Password:** password
- **Database:** restaurant_db

## Краткое описание проекта

Проект представляет собой современный API-сервис для бронирования столиков в ресторане, который:
- Позволяет клиентам легко забронировать столик, выбрав свободное время
- Гарантирует отсутствие пересечений бронирований благодаря бизнес-логике проверки временных интервалов
- Реализован с использованием FastAPI для высокой производительности и простоты разработки
- Использует Alembic для управления миграциями базы данных и Docker для удобного развертывания и масштабирования

Благодаря модульной архитектуре проект легко расширяется и поддерживается, что позволяет в будущем добавлять новые функции, такие как уведомления или интеграцию с другими сервисами.

## Заключение

Следуя приведённым инструкциям, вы сможете быстро развернуть и запустить API-сервис для бронирования столиков. Если возникнут вопросы или проблемы — обратитесь к документации по [FastAPI](https://fastapi.tiangolo.com/) и [Docker](https://docs.docker.com/).

